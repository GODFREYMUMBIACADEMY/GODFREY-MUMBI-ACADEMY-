<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Godfrey Mumbi Academy Dashboard</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #ffffff;
      color: #333;
    }
    header {
      background-color: #222;
      color: #fff;
      padding: 1rem;
      text-align: center;
    }
    section {
      padding: 1.5rem;
      border-bottom: 1px solid #ddd;
    }
    h2 {
      margin-top: 0;
    }
    .subject-section {
      margin-bottom: 2rem;
      border-radius: 8px;
      padding: 1rem;
      color: white;
    }
    .math { background-color: #1976d2; }        /* Blue */
    .english { background-color: #e53935; }     /* Red */
    .physics { background-color: #fb8c00; }     /* Orange */
    .chemistry { background-color: #43a047; }   /* Green */
    .biology { background-color: #8e24aa; }     /* Purple */
    .study-tips { background-color: #6d4c41; }  /* Brown */
    .motivation { background-color: #0097a7; }  /* Cyan */

    iframe {
      max-width: 100%;
      margin: 0.5rem 0;
    }

    footer {
      background-color: orange;
      color: white;
      text-align: center;
      padding: 1rem;
      font-style: italic;
    }

    ul {
      padding-left: 1.2rem;
    }

    a {
      color: #fff;
      text-decoration: underline;
    }

    a:hover {
      text-decoration: none;
    }

    .toggle-button {
      background-color: #000;
      color: #fff;
      padding: 0.5rem 1rem;
      margin-top: 1rem;
      border: none;
      cursor: pointer;
      border-radius: 5px;
      font-size: 1rem;
    }

    .toggle-content {
      display: none;
      margin-top: 1rem;
    }
    
    .loading {
      color: white;
      font-style: italic;
    }
    
    .video-container {
      position: relative;
      padding-bottom: 56.25%; /* 16:9 aspect ratio */
      height: 0;
      overflow: hidden;
      margin: 0.5rem 0;
    }
    
    .video-container iframe,
    .video-container video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>Subject Dashboard</h1>
  </header>

  <main>
    <!-- Mathematics -->
    <section class="subject-section math">
      <h2>Mathematics</h2>
      <button class="toggle-button" onclick="toggleContent(this)">🎥 Videos</button>
      <div class="toggle-content">
        <div class="loading">Loading math videos...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📚 Materials</button>
      <div class="toggle-content">
        <div class="loading">Loading math materials...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📝 Test Yourself</button>
      <div class="toggle-content">
        <div class="loading">Loading math quizzes...</div>
      </div>
    </section>

    <!-- English -->
    <section class="subject-section english">
      <h2>English</h2>
      <button class="toggle-button" onclick="toggleContent(this)">🎥 Videos</button>
      <div class="toggle-content">
        <div class="loading">Loading English videos...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📚 Materials</button>
      <div class="toggle-content">
        <div class="loading">Loading English materials...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📝 Test Yourself</button>
      <div class="toggle-content">
        <div class="loading">Loading English quizzes...</div>
      </div>
    </section>

    <!-- Physics -->
    <section class="subject-section physics">
      <h2>Physics</h2>
      <button class="toggle-button" onclick="toggleContent(this)">🎥 Videos</button>
      <div class="toggle-content">
        <div class="loading">Loading physics videos...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📚 Materials</button>
      <div class="toggle-content">
        <div class="loading">Loading physics materials...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📝 Test Yourself</button>
      <div class="toggle-content">
        <div class="loading">Loading physics quizzes...</div>
      </div>
    </section>

    <!-- Chemistry -->
    <section class="subject-section chemistry">
      <h2>Chemistry</h2>
      <button class="toggle-button" onclick="toggleContent(this)">🎥 Videos</button>
      <div class="toggle-content">
        <div class="loading">Loading chemistry videos...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📚 Materials</button>
      <div class="toggle-content">
        <div class="loading">Loading chemistry materials...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📝 Test Yourself</button>
      <div class="toggle-content">
        <div class="loading">Loading chemistry quizzes...</div>
      </div>
    </section>

    <!-- Biology -->
    <section class="subject-section biology">
      <h2>Biology</h2>
      <button class="toggle-button" onclick="toggleContent(this)">🎥 Videos</button>
      <div class="toggle-content">
        <div class="loading">Loading biology videos...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📚 Materials</button>
      <div class="toggle-content">
        <div class="loading">Loading biology materials...</div>
      </div>
      <button class="toggle-button" onclick="toggleContent(this)">📝 Test Yourself</button>
      <div class="toggle-content">
        <div class="loading">Loading biology quizzes...</div>
      </div>
    </section>

    <!-- Study/Exam Tips -->
    <section class="subject-section study-tips">
      <h2>Study/Exam Tips</h2>
      <button class="toggle-button" onclick="toggleContent(this)">🎥 Videos</button>
      <div class="toggle-content">
        <div class="loading">Loading study tips videos...</div>
      </div>
    </section>

    <!-- Motivation Videos -->
    <section class="subject-section motivation">
      <h2>Motivation</h2>
      <button class="toggle-button" onclick="toggleContent(this)">🎥 Videos</button>
      <div class="toggle-content">
        <div class="loading">Loading motivational videos...</div>
      </div>
    </section>
  </main>

  <footer>
    Godfrey Mumbi Academy — The way to simplify your education journey, the way to go.
  </footer>

  <script>
    // ====== CONFIGURATION ====== (Edit these values)
    const CONFIG = {
      githubUsername: "YOUR_GITHUB_USERNAME",  // Your GitHub username
      repoName: "YOUR_REPO_NAME",             // Your repository name
      branch: "main",                         // Your branch name (main/master)
      
      // Folder structure in your repository
      contentStructure: {
        videos: "videos",
        materials: "materials",
        quizzes: "quizzes"
      },
      
      // File extensions to recognize
      fileTypes: {
        videos: [".mp4", ".webm", ".youtube"],
        materials: [".pdf", ".docx", ".pptx"],
        quizzes: [".pdf", ".quiz"]
      }
    };

    // ====== AUTOMATIC CONTENT FETCHING ======
    async function fetchContent() {
      try {
        // Show loading state in all sections
        document.querySelectorAll('.loading').forEach(el => {
          el.textContent = "Loading content...";
        });
        
        // Fetch repository structure
        const apiUrl = `https://api.github.com/repos/${CONFIG.githubUsername}/${CONFIG.repoName}/git/trees/${CONFIG.branch}?recursive=1`;
        const response = await fetch(apiUrl);
        const data = await response.json();
        
        if (!data.tree) throw new Error("Failed to fetch repository structure");
        
        // Organize files by subject and type
        const organizedContent = {};
        
        data.tree.forEach(item => {
          if (item.type !== "blob") return; // Skip folders
          
          // Detect subject from path (e.g., "math/videos/file.mp4" → "math")
          const subjectMatch = item.path.match(/([^\/]+)\//);
          if (!subjectMatch) return;
          
          const subject = subjectMatch[1].toLowerCase();
          if (!document.querySelector(`.${subject}`)) return;
          
          // Detect content type (videos/materials/quizzes)
          let contentType = null;
          for (const [type, folder] of Object.entries(CONFIG.contentStructure)) {
            if (item.path.includes(`/${folder}/`)) {
              contentType = type;
              break;
            }
          }
          if (!contentType) return;
          
          // Check file extension
          const fileExt = item.path.substring(item.path.lastIndexOf('.')).toLowerCase();
          if (!CONFIG.fileTypes[contentType].includes(fileExt)) return;
          
          // Add to organized content
          if (!organizedContent[subject]) organizedContent[subject] = {};
          if (!organizedContent[subject][contentType]) organizedContent[subject][contentType] = [];
          
          organizedContent[subject][contentType].push({
            name: item.path.split('/').pop(),
            url: `https://raw.githubusercontent.com/${CONFIG.githubUsername}/${CONFIG.repoName}/${CONFIG.branch}/${item.path}`,
            path: item.path
          });
        });
        
        // Update the dashboard
        updateDashboard(organizedContent);
        
      } catch (error) {
        console.error("Error fetching content:", error);
        document.querySelectorAll('.loading').forEach(el => {
          el.textContent = "Error loading content. Please try again later.";
        });
      }
    }

    // ====== UPDATE DASHBOARD DISPLAY ======
    function updateDashboard(content) {
      // For each subject with content
      Object.keys(content).forEach(subject => {
        const section = document.querySelector(`.${subject}`);
        if (!section) return;
        
        // For each content type (videos/materials/quizzes)
        Object.keys(content[subject]).forEach(contentType => {
          // Find matching button and container
          const button = [...section.querySelectorAll(".toggle-button")].find(btn => 
            (contentType === "videos" && btn.textContent.includes("Videos")) ||
            (contentType === "materials" && btn.textContent.includes("Materials")) ||
            (contentType === "quizzes" && btn.textContent.includes("Test Yourself"))
          );
          
          if (!button) return;
          
          const container = button.nextElementSibling;
          const items = content[subject][contentType];
          
          // Generate HTML based on content type
          let html = "";
          if (contentType === "videos") {
            items.forEach(item => {
              // Handle YouTube links (.youtube files)
              if (item.name.endsWith(".youtube")) {
                const videoId = item.name.replace(".youtube", "");
                html += `
                  <div class="video-container">
                    <iframe src="https://www.youtube.com/embed/${videoId}" 
                            frameborder="0" 
                            allowfullscreen></iframe>
                  </div>
                `;
              } 
              // Handle direct video files
              else {
                html += `
                  <div class="video-container">
                    <video controls style="width:100%;">
                      <source src="${item.url}" type="video/${item.name.split('.').pop()}">
                    </video>
                  </div>
                `;
              }
            });
          } 
          // For materials and quizzes
          else {
            html = "<ul>";
            items.forEach(item => {
              const displayName = item.name.replace(/\.[^/.]+$/, "").replace(/[-_]/g, " ");
              html += `<li><a href="${item.url}" target="_blank">${displayName}</a></li>`;
            });
            html += "</ul>";
          }
          
          container.innerHTML = items.length > 0 ? html : "<p>No content found for this section.</p>";
        });
      });
    }

    // ====== TOGGLE SECTIONS ======
    function toggleContent(button) {
      const content = button.nextElementSibling;
      content.style.display = content.style.display === "block" ? "none" : "block";
      
      // If opening and content isn't loaded yet
      if (content.style.display === "block" && content.querySelector(".loading")) {
        fetchContent();
      }
    }

    // ====== INITIALIZE ======
    document.addEventListener("DOMContentLoaded", function() {
      // Load content for any already open sections
      const openSections = document.querySelectorAll(".toggle-content[style='display: block;']");
      openSections.forEach(section => {
        if (section.querySelector(".loading")) {
          fetchContent();
        }
      });
    });
  </script>
</body>
</html>
